{
  "hash": "8111fc2502ed1ba43a8af0d068c80b45",
  "result": {
    "markdown": "---\ntitle: \"Dia-01\"\n---\n\n::: {.cell}\n\n:::\n\n\n# Tópicos dia 1:\n\n-   Breve descrição dos pacotes utilizados\n-   Introdução aos dados utilizados\n\n## 1 Introdução aos Dados Funcionais e longitudinais {#secao-1}\n\nDados Funcionais: Dados funcionais são uma forma de representar informações observadas ao longo de uma dimensão contínua, geralmente o tempo. Em vez de ter observações pontuais em momentos específicos, os dados funcionais registram a evolução de uma variável ao longo de uma curva contínua, muitas vezes representada como uma função. Essa função pode ser descrita por uma série de pontos discretos ou através de uma representação contínua, como uma curva suave. Dados funcionais são frequentemente utilizados em áreas como análise de séries temporais, análise de imagens médicas, processamento de sinais, entre outras.\n\nDados Longitudinais: Dados longitudinais referem-se a dados coletados repetidamente de um mesmo indivíduo, objeto ou unidade de estudo ao longo do tempo. Nesse tipo de dado, o foco está na observação das mudanças que ocorrem em uma variável ou conjunto de variáveis ao longo de diferentes momentos. Os dados longitudinais permitem analisar tendências, padrões de crescimento, estabilidade ou mudanças em uma população ao longo do tempo. São comumente utilizados em estudos longitudinais, pesquisas de acompanhamento de indivíduos, estudos de coorte e estudos de desenvolvimento, entre outros.\n\nEm resumo, dados funcionais representam a evolução de uma variável em uma dimensão contínua, enquanto dados longitudinais referem-se a observações repetidas de uma mesma unidade de estudo ao longo do tempo. Ambos os tipos de dados são valiosos para análises estatísticas e científicas em diferentes áreas de estudo.\n\n## 2 Instalando os pacotes que serão utilizados\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nif(!require(pacman)) install.packages(c(\"pacman\", # instalando os pacotes necessários\n                                        \"tidyverse\",\n                                        \"lme4\",\n                                        \"mgcv\",\n                                        \"refund\",\n                                        \"face\",\n                                        \"fda\", \n                                        \"rgl\",\n                                        \"fields\",\n                                        \"refund.shiny\",\n                                        \"janitor\"))\n```\n:::\n\n\nCarregando os pacotes simultaneamente utilizando o pacote `pacman`\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\npacman::p_load(tidyverse, lme4, mgcv, refund, face, fda, rgl, fields, refund.shiny, janitor)\n```\n:::\n\n\nPacotes para estimação dos modelos\n\n-   `lme4` - modelos lineares, lineares generalizados, e modelos mistos não lineares\n-   `mgcv` - modelos aditivos generalizados (mistos); suavização semi-paramétrica\n-   `refund` - modelos de regressão usando dados funcionais\n-   `face` - para estimativa rápida de covariância para dados funcionais esparsos\n-   `fda` - para análise de dados funcionais\n\nPacotes para manipulação e visualização dos dados\n\n-   `tidyverse` - auxilia na importação, organização, manipulação e visualização de dados\n-   `rgl` - gráficos 3d\n-   `refund.shiny` - gráficos interativos para análise de dados funcionais\n\n## 3 Dados utilizados no curso\n\nPara este curso, exploraremos e analisaremos os seguintes conjuntos de dados (onde encontrar):\n\n-   Dados de imagem de tensor de difusão (\"DTI\" pacote refund)\n-   Dados meteorológicos canadenses (\"CanadianWeather\" pacote fda)\n-   Dados de crescimento de Berkeley (\"growth\" pacote fda)\n-   Dados CD4 (\"cd4\" pacote refund)\n\n### 3.1 Dados de imagem de tensor de difusão\n\nOs dados de imagem de tensor de difusão (DTI - Diffusion Tensor Imaging) são amplamente utilizados em estudos sobre esclerose múltipla (EM) e em outras áreas de pesquisa neurocientífica. A DTI é uma técnica de ressonância magnética que permite avaliar a microestrutura e a conectividade das fibras nervosas no cérebro.\n\nNa esclerose múltipla, a DTI pode ser usada para detectar e quantificar as alterações nas propriedades de difusão da água nos tecidos cerebrais. Essas alterações podem ser indicativas de danos ou desmielinização das fibras nervosas, que são características da EM.\n\nOs principais parâmetros medidos na DTI incluem a difusão isotrópica (representada pela medida do coeficiente de difusão isotrópica - ADC) e a difusão anisotrópica (representada pelos valores de fração anisotrópica - FA). A FA é particularmente importante na DTI, pois fornece informações sobre a direcionalidade das fibras nervosas e sua integridade estrutural.\n\nAo analisar os dados de DTI na EM, os pesquisadores podem investigar as alterações na integridade das fibras nervosas, a presença de lesões ou placas desmielinizantes e o impacto dessas alterações na conectividade e no funcionamento cerebral dos pacientes com EM. Além disso, a DTI também pode ser usada para avaliar a progressão da doença ao longo do tempo e monitorar a eficácia de intervenções terapêuticas.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Os dados de DTI vem do pacote refund\ndata(\"DTI\")\nnames(DTI)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"ID\"         \"visit\"      \"visit.time\" \"Nscans\"     \"case\"      \n[6] \"sex\"        \"pasat\"      \"cca\"        \"rcst\"      \n```\n:::\n:::\n\n\nAqui vamos considerar apenas os casos completos, de pacientes com EM em suas prinmeiras visitas.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# filtrando apenas os casos completos ----\nDTI2 <- DTI %>% \n  drop_na() %>% \n  filter(visit == 1 & case == 1)\n\n# verificando as dimensoes dos dados de CCA\n# F1 para mais infomações sobre o formato dos dados\ndim(DTI2$cca)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 66 93\n```\n:::\n\n```{.r .cell-code}\n# arrumando os dados para o gráfico ----\nDTI2$cca %>% \n  t() %>% \n  as_tibble() %>% \n janitor::clean_names() %>% \n  mutate(\n    tract = 1:93\n  ) %>% \n  pivot_longer(cols = starts_with(\"x\")) %>% \n  \n  ggplot(aes(tract, value, group = name, colour = name))+ #gráfico de todos os 66 casos completos\n  geom_line()+\n  theme(legend.position = \"none\")+\n  labs(x=\"tract\",\n       y =\"Anisotropia Fracionária (AF)\",\n       title = \"imagem de tensor de difusão:CCA\")\n```\n\n::: {.cell-output-display}\n![](dia01_files/figure-html/unnamed-chunk-4-1.png){fig-align='center' width=100%}\n:::\n\n```{.r .cell-code}\n# gráfico da média dos dados ----\n\nDTI2$cca %>% \n  t() %>% \n  as_tibble() %>% \n janitor::clean_names() %>% \n  mutate(\n    tract = 1:93\n  ) %>% \n  pivot_longer(cols = starts_with(\"x\")) %>% \n  group_by(tract) %>% \n  mutate(\n    avg = mean(value)\n  ) %>% \n  ggplot(aes(tract, value, group = name))+\n  geom_line(color = \"gray\")+\n  geom_line(aes(tract,avg), color = \"red\",linewidth = 2, linetype = 1)+\n  theme(legend.position = \"none\")+\n  labs(x=\"tract\",\n       y =\"Anisotropia Fracionária (AF)\",\n       title = \"imagem de tensor de difusão:CCA\")\n```\n\n::: {.cell-output-display}\n![](dia01_files/figure-html/unnamed-chunk-4-2.png){fig-align='center' width=100%}\n:::\n:::\n\n\nAlém das medidas de AF, o conjunto de dados DTI também inclui as pontuações do Teste de Adição Auditiva em Série (PASAT) dos pacientes, que medem suas funções cognitivas. Os gráficos a seguir ajudam a visualizar a relação entre as medições de AF e as pontuações do PASAT, codificadas por cores.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n#[code by R. Todd Ogden and Jeff Goldsmith]\n\ntract <- 1:93\ncolfct <- as.numeric(cut(DTI2$pasat, 40))\n\npar(mar=c(1,1,0,0), cex.axis=1, cex.lab=1)\nclrs <- rev(colorRampPalette(c(\"blue\", \"green\", \"yellow\", \"red\"))(40))    \n\nproj = persp(x = tract, y = seq(min(DTI2$pasat), max(DTI2$pasat), l=length(DTI2$pasat)),  z=t(DTI2$cca),\n  xlab=\"tract\", ylab=\"PASAT\", zlab=\"AF\", col=NA, border=NA,\n  ticktype = \"detailed\", axes=TRUE, theta=30, phi=30)\n\no <- rev(order(DTI2$pasat))\nfor(i in o){\n  lines(trans3d(x = tract, y=rep(DTI2$pasat[i], ncol(DTI2$cca)),  z=DTI2$cca[i,], pmat=proj), col=clrs[colfct[i]])\n}\n```\n\n::: {.cell-output-display}\n![](dia01_files/figure-html/unnamed-chunk-5-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\nQuestões de interesse:\n\n-   [Como as medições de AF ao longo do CCA variam entre os indivíduos com EM?](respostas.qmd#exercicio-1.1)\n\n-   [Qual é a associação entre medições de AF e funções cognitivas (pontuações PASAT)?](respostas.qmd#exercicio-1.2)\n\n-   [O perfil típico de AF varia entre pacientes com EM e indivíduos saudáveis?](respostas.qmd#exercicio-1.3)\n\n### 3.2 Dados meteorológicos do Canadá\n\nO banco de dados Canadian Weather contém informações sobre as temperaturas e precipitações diárias registradas em 35 estações meteorológicas localizadas no Canadá. Os dados abrangem um período de 365 dias, fornecendo uma série temporal de temperaturas para cada estação (Ramsay and Silverman, 2002).\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Arrumando os dados diários de temperatura para todas as estações\ndaily_data_temp <- CanadianWeather$dailyAv %>% \n  as_tibble() %>% \n  dplyr::select(contains(\"Temperature\")) %>% \n  rownames_to_column(var = \"day\") %>% \n  mutate(\n    day = as.numeric(day)\n  )  \n \n\n# Criando o gráfico dos dados de teperatura diária\ndaily_data_temp %>% \n  pivot_longer(cols = c(2:ncol(daily_data_temp))) %>% \n  group_by(day) %>% \n  ggplot(aes(day,value, color = name ))+\n  geom_line()+\n  theme(legend.position = \"none\")+\n  labs(x = \"day\", y = \"Temperatura c°\", title = \"Temperaturas diárias\")\n```\n\n::: {.cell-output-display}\n![](dia01_files/figure-html/unnamed-chunk-6-1.png){fig-align='center' width=100%}\n:::\n\n```{.r .cell-code}\n# Criando o gráfico com o comportamento médio dos dados\ndaily_data_temp %>% \n  pivot_longer(cols = c(2:ncol(daily_data_temp))) %>% \n  group_by(day) %>% \n  mutate(\n    avg = mean(value)\n  ) %>% \n  ggplot(aes(day,value, group = name))+\n  geom_line(color = \"gray\")+\n  geom_line(aes(day, avg), color = \"red\", linewidth = 2, linetype = 1)+\n  theme(legend.position = \"none\")+\n  labs(x = \"day\", y = \"Temperatura c°\", title = \"Temperaturas diárias - c/média\")\n```\n\n::: {.cell-output-display}\n![](dia01_files/figure-html/unnamed-chunk-6-2.png){fig-align='center' width=100%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Arrumando os dados diários de preciptação para todas as estações\ndaily_data_prec <- CanadianWeather$dailyAv %>% \n  as_tibble() %>% \n  dplyr::select(contains(\"Precipitation\")) %>% \n  rownames_to_column(var = \"day\") %>% \n  mutate(\n    day = as.numeric(day)\n  )  \n\n\n# Criando o gráfico dos dados de precipitação diária\ndaily_data_prec %>% \n  pivot_longer(cols = c(2:ncol(daily_data_prec))) %>% \n  group_by(day) %>% \n  ggplot(aes(day,value, color = name ))+\n  geom_line()+\n  theme(legend.position = \"none\")+\n  labs(x = \"day\", y = \"Precipitação mm\", title = \"Precipitação diária\")\n```\n\n::: {.cell-output-display}\n![](dia01_files/figure-html/unnamed-chunk-7-1.png){fig-align='center' width=100%}\n:::\n\n```{.r .cell-code}\n# Criando o gráfico com o comportamento médio dos dados\ndaily_data_prec %>% \n  pivot_longer(cols = c(2:ncol(daily_data_prec))) %>% \n  group_by(day) %>% \n  mutate(\n    avg = mean(value)\n  ) %>% \n  ggplot(aes(day,value, group = name))+\n  geom_line(color = \"gray\")+\n  geom_line(aes(day, avg), color = \"red\", linewidth = 2, linetype = 1)+\n  theme(legend.position = \"none\")+\n  labs(x = \"day\", y = \"Precipitação mm\", title = \"Precipitação diária c/média\")\n```\n\n::: {.cell-output-display}\n![](dia01_files/figure-html/unnamed-chunk-7-2.png){fig-align='center' width=100%}\n:::\n:::\n\n\nQuestões de interesse:\n\n-   [Descrever características que caracterizam os perfis diários de temperatura.](respostas.qmd#exercicio-1.4)\n\n-   [Qual é a associação entre a precipitação média anual e a temperatura diária no Canadá?](respostas.qmd#exercicio-1.5)\n\n-   [E quanto à associação entre as precipitações diárias e os perfis de temperatura.](respostas.qmd#exercicio-1.6)\n\n### 3.3 Dados CD4\n\nAs células imunes (células CD4) são tipicamente atacadas pelo HIV (vírus da imunodeficiência humana); A contagem de células CD4 por mm de sangue é um substituto útil da progressão do HIV. O estudo Multicenter Aids Cohort (disponível no pacote de reembolso) coletou as contagens de células CD4 de 366 indivíduos afetados entre -18 e 42 meses desde a soroconversão (diagnóstico de HIV).\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndata(cd4)\nview(cd4)\n\ncd4_tidy <- cd4 %>%\n  as_tibble() %>% \n rowid_to_column(var = \"affected\") %>% \n  pivot_longer(cols = 2:62, names_to = \"months\", values_to = \"count-mm\" ) %>% \n  mutate(\n    months = as.numeric(months)\n  )\n\ncd4_tidy %>% \n  group_by(months) %>% \n  drop_na() %>% \n  ggplot(aes(months, `count-mm`, group = affected, color = affected))+\n  geom_line()+\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](dia01_files/figure-html/unnamed-chunk-8-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\nQuestões de interesse:\n\n[Como as contagens de CD4 variam ao longo do tempo na população, bem como no nível individual?](respostas.qmd#exercicio-1.7)\n\n[Descreva as principais direções nas quais as contagens de CD4 variam.](respostas.qmd#exercicio-1.8)\n\n### 3.4 Dados da maratona de Boston (Kaggle)\n\nInfelizmente eu não encontrei os dados utilizados no curso original, para substituir eu vou utilizar os dados sobre a [maratona de Boston](https://www.kaggle.com/datasets/rojour/boston-results). Que como veremos não são o ideal para o proposito do curso. \n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](dia01_files/figure-html/unnamed-chunk-9-1.png){fig-align='center' width=100%}\n:::\n\n::: {.cell-output-display}\n![](dia01_files/figure-html/unnamed-chunk-9-2.png){fig-align='center' width=100%}\n:::\n\n::: {.cell-output-display}\n![](dia01_files/figure-html/unnamed-chunk-9-3.png){fig-align='center' width=100%}\n:::\n:::\n\n\n[Descreva os gráficos - como a estratégia de corrida difere entre os corredores?](respostas.qmd#exercicio-1.9)\n\nPerguntas de interesse:\n\n - [Como a velocidade varia ao longo de uma maratona?](respostas.qmd#exercicio-1.10)\n\n - [Qual é a relação entre o comportamento da velocidade durante a maratona e o tempo de chegada?](respostas.qmd#exercicio-1.11)\n\n - [Qual é a melhor estratégia para terminar a maratona entre os cinco primeiros colocados?](respostas.qmd#exercicio-1.12)\n\n### 3.5 Dados de Poluentes PM2.5.\n\nO parâmetro PM2.5 se refere a partículas finas em suspensão no ar, com diâmetro igual ou inferior a 2,5 micrômetros (µm). Essas partículas são consideradas pequenas e podem ser inaladas facilmente, penetrando profundamente nos pulmões e até mesmo na corrente sanguínea.\n\nO PM2.5 é uma medida comumente utilizada para avaliar a qualidade do ar e os riscos associados à poluição atmosférica. Essas partículas podem ser geradas por diversas fontes, incluindo a queima de combustíveis fósseis, a poluição industrial, a queima de biomassa, os veículos automotores e as atividades agrícolas.\n\nA exposição prolongada ao PM2.5 tem sido associada a uma série de efeitos adversos à saúde, incluindo problemas respiratórios, doenças cardiovasculares, efeitos neurológicos, além de aumentar o risco de câncer de pulmão. Além disso, o PM2.5 pode contribuir para a formação de nevoeiros e reduzir a visibilidade.\n\nPara monitorar a concentração de PM2.5, são utilizadas estações de monitoramento que coletam amostras de ar e medem a quantidade de partículas presentes. Os dados coletados são geralmente expressos em microgramas por metro cúbico (µg/m³) e são usados para avaliar a qualidade do ar, implementar medidas de controle da poluição e informar o público sobre os níveis de poluição atmosférica.\n\nEm resumo, o parâmetro PM2.5 é uma medida importante para avaliar a poluição atmosférica e os riscos à saúde associados a partículas finas presentes no ar. Sua monitorização contínua é essencial para proteger a saúde pública e tomar medidas efetivas para reduzir a exposição a essas partículas poluentes.\n\n\nAssim como no caso dos dados da maratona, eu não consegui encontrar os dados usados originalmente no curso. Para substituilos vamos usar os dados disponibilizados na plataforma Keggle referentes as diferentes cidades da china. [link para os dados](https://www.kaggle.com/datasets/uciml/pm25-data-for-five-chinese-cities)\n\nAs informações desse conjunto de dados diferem dos dados usados originalemente! Logo voltaremos a esse conjunto de dados e vamos tentar descobrir quais questões podem ser respondidas ao analisa-lo.\n\nA principio vamos utilizar os dados da cidade de Beijing, onde temos dados registrados em 4 diferentes localidade, de hora em hora, durante todo o ano de 2015.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\npm2.5_beijing <-  read_csv(\"pm2.5_dados/BeijingPM20100101_20151231.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 52584 Columns: 18\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (1): cbwd\ndbl (17): No, year, month, day, hour, season, PM_Dongsi, PM_Dongsihuan, PM_N...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n```{.r .cell-code}\npm2.5_beijing %>% \n  dplyr::filter(year==2015) %>% \n  mutate(\n    data_hora = as.POSIXct(paste(year, month, day, hour, sep = \"-\"), format = \"%Y-%m-%d-%H\")\n  ) %>% \n  pivot_longer(cols = contains(\"PM\")) %>% \n  ggplot(aes(data_hora,value,group=name,color=name))+\n  geom_line()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 7 rows containing missing values (`geom_line()`).\n```\n:::\n\n::: {.cell-output-display}\n![](dia01_files/figure-html/unnamed-chunk-10-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n\n### 3.6 Dados de crescimento de Berkeley\n\nO conjunto de dados Berkeley Growth Data (também conhecido como Berkeley Growth Study) é um conjunto de dados histórico amplamente utilizado em pesquisas sobre crescimento e desenvolvimento infantil, contendo em alturas de 39 meninos e 54 meninas de 1 a 18 anos e as idades em que foram coletados. Esse conjunto de dados foi coletado como parte do Berkeley Growth Study, que ocorreu na Universidade da Califórnia, Berkeley, durante o século XX.\n\nO Berkeley Growth Data contém informações longitudinais de medidas antropométricas (como altura e peso) de um grande número de crianças desde o nascimento até a idade adulta. As medidas foram coletadas em intervalos regulares ao longo de vários anos, permitindo uma análise detalhada do crescimento e desenvolvimento ao longo do tempo.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndata(\"growth\")\nview(growth)\n\n# Separando os dados referentes aos meninos\ngrowth_boy <- growth$hgtm %>%\n  as_tibble() %>% \n   mutate(\n     age = growth$age\n     )\n# Separando os dados referentes as meninas\ngrowth_girl <- growth$hgtf %>%\n  as_tibble() %>% \n  mutate(\n    age = growth$age\n  )\n\n# unificando os dois conuntos e criando uma variável gênero\ngrowth_df <- left_join(\n  growth_boy,\n  growth_girl,\n  by = \"age\") %>% \n  pivot_longer(\n    cols = contains(c(\"boy\",\"girl\")),\n    names_to = \"kids\",\n    values_to = \"height\") %>% \n   mutate(\n    gender = if_else(stringr::str_starts(kids, \"boy\"), \"M\", \"F\")\n  )\n\n\n# curva de crescimento \ngrowth_df %>%  \n   group_by(age) %>% \n  ggplot(aes(age, height, group = kids, color = gender))+\n  geom_line()\n```\n\n::: {.cell-output-display}\n![](dia01_files/figure-html/unnamed-chunk-11-1.png){fig-align='center' width=100%}\n:::\n\n```{.r .cell-code}\n# taxa de crescimento \ngrowth_df %>%  \n  group_by(kids, gender) %>% \n  mutate(\n    g_rate = c(0,diff(height))\n  ) %>%\n  ggplot(aes(age, g_rate, group = kids,color = gender))+\n  geom_line()\n```\n\n::: {.cell-output-display}\n![](dia01_files/figure-html/unnamed-chunk-11-2.png){fig-align='center' width=100%}\n:::\n:::\n\n\nQuestões de interesse:\n\nComo a altura varia em meninos e meninas?\n\nO género tem impacto no processo de crescimento de uma criança?\n\n## 4 Resumo :\n\nIntrodução dos quatro conjuntos de dados com características funcionais (ou longitudinais).\n\nDiscutiu possíveis questões científicas para cada conjunto de dados.\n",
    "supporting": [
      "dia01_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}